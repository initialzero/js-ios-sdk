<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">

	<title>RKManagedObjectStore Class Reference</title>

	<link rel="stylesheet" href="../css/style.css">
	<meta name="viewport" content="initial-scale=1, maximum-scale=1.4">
	<meta name="generator" content="appledoc 2.2.1 (build 1334)">
</head>
<body class="appledoc">
	<header>
		<div class="container" class="hide-in-xcode">
			
			<h1 id="library-title">
				<a href="../index.html">JaspersoftSDK </a>
			</h1>

			<p id="developer-home">
				<a href="../index.html">TIBCO Jaspersoft</a>
			</p>
			
		</div>
	</header>

	<aside>
		<div class="container">
			<nav>
				<ul id="header-buttons" role="toolbar">
					<li><a href="../index.html">Index</a></li>
<li><a href="../hierarchy.html">Hierarchy</a></li>

					<li id="on-this-page" role="navigation">
						<label>
							On This Page

							<div class="chevron">
								<div class="chevy chevron-left"></div>
								<div class="chevy chevron-right"></div>
							</div>

							<select id="jump-to">
	<option value="top">Jump To&#133;</option>
	
	<option value="overview">Overview</option>
	

	
	
	<option value="tasks">Tasks</option>
	
	

	
	
	<optgroup label="Properties">
		
		<option value="//api/name/mainQueueManagedObjectContext">mainQueueManagedObjectContext</option>
		
		<option value="//api/name/managedObjectCache">managedObjectCache</option>
		
		<option value="//api/name/managedObjectModel">managedObjectModel</option>
		
		<option value="//api/name/persistentStoreCoordinator">persistentStoreCoordinator</option>
		
		<option value="//api/name/persistentStoreManagedObjectContext">persistentStoreManagedObjectContext</option>
		
	</optgroup>
	

	
	<optgroup label="Class Methods">
		
		<option value="//api/name/defaultStore">+ defaultStore</option>
		
		<option value="//api/name/migratePersistentStoreOfType:atURL:toModelAtURL:error:configuringModelsWithBlock:">+ migratePersistentStoreOfType:atURL:toModelAtURL:error:configuringModelsWithBlock:</option>
		
		<option value="//api/name/setDefaultStore:">+ setDefaultStore:</option>
		
	</optgroup>
	

	
	<optgroup label="Instance Methods">
		
		<option value="//api/name/addInMemoryPersistentStore:">- addInMemoryPersistentStore:</option>
		
		<option value="//api/name/addSQLitePersistentStoreAtPath:fromSeedDatabaseAtPath:withConfiguration:options:error:">- addSQLitePersistentStoreAtPath:fromSeedDatabaseAtPath:withConfiguration:options:error:</option>
		
		<option value="//api/name/copySeedDatabaseIfNecessaryFromPath:toPath:error:">- copySeedDatabaseIfNecessaryFromPath:toPath:error:</option>
		
		<option value="//api/name/createManagedObjectContexts">- createManagedObjectContexts</option>
		
		<option value="//api/name/createPersistentStoreCoordinator">- createPersistentStoreCoordinator</option>
		
		<option value="//api/name/init">- init</option>
		
		<option value="//api/name/initWithManagedObjectModel:">- initWithManagedObjectModel:</option>
		
		<option value="//api/name/initWithPersistentStoreCoordinator:">- initWithPersistentStoreCoordinator:</option>
		
		<option value="//api/name/newChildManagedObjectContextWithConcurrencyType:tracksChanges:">- newChildManagedObjectContextWithConcurrencyType:tracksChanges:</option>
		
		<option value="//api/name/resetPersistentStores:">- resetPersistentStores:</option>
		
	</optgroup>
	
	
</select>
						</label>
					</li>
				</ul>
			</nav>
		</div>
	</aside>

	<article>
		<div id="overview_contents" class="container">
			<div id="content">
				<main role="main">
					<h1 class="title">RKManagedObjectStore Class Reference</h1>

					
					<div class="section section-specification"><table cellspacing="0"><tbody>
						<tr>
	<th>Inherits from</th>
	<td>NSObject</td>
</tr><tr>
	<th>Declared in</th>
	<td>RKManagedObjectStore.h<br />RKManagedObjectStore.m</td>
</tr>
						</tbody></table></div>
					

                    
					
					<div class="section section-overview">
						<a title="Overview" name="overview"></a>
						<h2 class="subtitle subtitle-overview">Overview</h2>
						<p>The <code>RKManagedObjectStore</code> class encapsulates a Core Data stack including a managed object model, a persistent store coordinator, and a set of managed object contexts. The managed object store simplifies the task of properly setting up a Core Data stack and provides some additional functionality, such as the use of a seed database to initialize a SQLite backed persistent store and a simple code path for resetting the store by destroying and recreating the persistent stores.</p>

<h2>Initialization</h2>

<p>The managed object store is designed to easily initialize a Core Data stack in a recommended configuration. A store object must always be initialized with a managed object model, but this managed object model can be directly provided, inferred from an already configured persistent store coordinator, or read from the currently available bundles within the application. Note that several features provided by the framework rely on the store being initialized with a mutable managed object model. Please refer to the documentation in the <a href="#//api/name/initWithManagedObjectModel:"><code>initWithManagedObjectModel:</code></a> for details.</p>

<h2>Managed Object Contexts</h2>

<p>The managed object store provides the application developer with a pair of managed object contexts with which to work with Core Data. The store configures a primary managed object context with the NSPrivateQueueConcurrencyType that is associated with the persistent store coordinator for handling Core Data persistence. A second context is also created with the NSMainQueueConcurrencyType that is a child of the primary managed object context for doing work on the main queue. Additional child contexts can be created directly or via a convenience method interface provided by the store (see <a href="#//api/name/newChildManagedObjectContextWithConcurrencyType:tracksChanges:">newChildManagedObjectContextWithConcurrencyType:tracksChanges:</a>).</p>

<p>The managed object context hierarchy is designed to isolate the main thread from disk I/O and avoid deadlocks. Because the primary context manages its own private queue, saving the main queue context will not result in the objects being saved to the persistent store. The primary context must be saved as well for objects to be persisted to disk.</p>

<p>It is also worth noting that because of the parent/child context hierarchy, objects created on the main thread will not obtain permanent managed object ID&rsquo;s even after the primary context has been saved. If you need to refer to the permanent representations of objects created on the main thread after a save, you may ask the main queue context to obtain permanent managed objects for your objects via <code>obtainPermanentIDsForObjects:error:</code>. Be warned that when obtaining permanent managed object ID&rsquo;s, you must include all newly created objects that are reachable from the object you are concerned with in the set of objects provided to <code>obtainPermanentIDsForObjects:error:</code>. This means any newly created object in a one-to-one or one-to-many relationship must be provided or you will face a crash from the managed object context. This is due to a bug in Core Data still present in iOS5, but fixed in iOS6 (see Open Radar <a href="http://openradar.appspot.com/11478919">http://openradar.appspot.com/11478919).</a>.)</p>
					</div>
					
					

					
					
					<div class="section section-tasks">
						<a title="Tasks" name="tasks"></a>
						

						<a title="Accessing the Default Object Store" name="task_Accessing the Default Object Store"></a>
						<h2 class="task-title">Accessing the Default Object Store</h2>

						<div class="task-list">
							<div class="section-method">
	<a name="//api/name/defaultStore" title="defaultStore"></a>
	<h3 class="method-title"><code><a href="#//api/name/defaultStore">+&nbsp;defaultStore</a></code>
</h3>

	<div class="method-info">
		<div class="pointy-thing"></div>

		<div class="method-info-container">
			
			
			<div class="method-subsection brief-description">
				<p>Returns the default managed object store for the application.</p>
			</div>
			
		    

			<div class="method-subsection method-declaration"><code>+ (instancetype)defaultStore</code></div>

		    
			

			
			<div class="method-subsection return">
				<h4 class="method-subtitle parameter-title">Return Value</h4>
				<p>The default managed object store.</p>
			</div>
			

			

			

			

			

			
			<div class="method-subsection declared-in-section">
				<h4 class="method-subtitle">Declared In</h4>
				<p><code class="declared-in-ref">RKManagedObjectStore.h</code></p>
			</div>
			
			
		</div>
	</div>
</div><div class="section-method">
	<a name="//api/name/setDefaultStore:" title="setDefaultStore:"></a>
	<h3 class="method-title"><code><a href="#//api/name/setDefaultStore:">+&nbsp;setDefaultStore:</a></code>
</h3>

	<div class="method-info">
		<div class="pointy-thing"></div>

		<div class="method-info-container">
			
			
			<div class="method-subsection brief-description">
				<p>Sets the default managed object store for the application.</p>
			</div>
			
		    

			<div class="method-subsection method-declaration"><code>+ (void)setDefaultStore:(RKManagedObjectStore *)<em>managedObjectStore</em></code></div>

		    
			
			<div class="method-subsection arguments-section parameters">
				<h4 class="method-subtitle parameter-title">Parameters</h4>
				<table class="argument-def parameter-def">
				
					<tr>
						<th scope="row" class="argument-name"><code>managedObjectStore</code></th>
						<td><p>The new default managed object store.</p></td>
					</tr>
				
				</table>
			</div>
			

			

			

			

			

			

			
			<div class="method-subsection declared-in-section">
				<h4 class="method-subtitle">Declared In</h4>
				<p><code class="declared-in-ref">RKManagedObjectStore.h</code></p>
			</div>
			
			
		</div>
	</div>
</div>
						</div>
						

						<a title="Initializing an Object Store" name="task_Initializing an Object Store"></a>
						<h2 class="task-title">Initializing an Object Store</h2>

						<div class="task-list">
							<div class="section-method">
	<a name="//api/name/initWithManagedObjectModel:" title="initWithManagedObjectModel:"></a>
	<h3 class="method-title"><code><a href="#//api/name/initWithManagedObjectModel:">&ndash;&nbsp;initWithManagedObjectModel:</a></code>
</h3>

	<div class="method-info">
		<div class="pointy-thing"></div>

		<div class="method-info-container">
			
			
			<div class="method-subsection brief-description">
				<p>Initializes the receiver with a given managed object model. This is the designated initializer for <code>RKManagedObjectStore</code>.</p>
			</div>
			
		    

			<div class="method-subsection method-declaration"><code>- (instancetype)initWithManagedObjectModel:(NSManagedObjectModel *)<em>managedObjectModel</em></code></div>

		    
			
			<div class="method-subsection arguments-section parameters">
				<h4 class="method-subtitle parameter-title">Parameters</h4>
				<table class="argument-def parameter-def">
				
					<tr>
						<th scope="row" class="argument-name"><code>managedObjectModel</code></th>
						<td><p>The managed object model with which to initialize the receiver.</p></td>
					</tr>
				
				</table>
			</div>
			

			
			<div class="method-subsection return">
				<h4 class="method-subtitle parameter-title">Return Value</h4>
				<p>The receiver, initialized with the given managed object model.</p>
			</div>
			

			

			
			<div class="method-subsection discussion-section">
				<h4 class="method-subtitle">Discussion</h4>
				<div class="bug"><p><strong>Bug:</strong> Several features require that the managed object model used to initialize the store be mutable so that entities may be changed before the persistent store coordinator is created. Since iOS 5, managed object models initialized via initWithContentsOfURL: return an immutable model. The application developer must send the returned managed object model a mutable copy message to ensure that it is mutable before initializing the managed object store. The recommended approach for initializing a managed object store is as follows:</p>

<pre><code>NSURL *modelURL = [NSURL fileURLWithPath:[[NSBundle mainBundle] pathForResource:@"MyApplication" ofType:@"momd"]];
// NOTE: Due to an iOS 5 bug, the managed object model returned is immutable.
NSManagedObjectModel *managedObjectModel = [[[NSManagedObjectModel alloc] initWithContentsOfURL:modelURL] mutableCopy];
RKManagedObjectStore *managedObjectStore = [[RKManagedObjectStore alloc] initWithManagedObjectModel:managedObjectModel];
</code></pre></div>
			</div>
			

			

			

			
			<div class="method-subsection declared-in-section">
				<h4 class="method-subtitle">Declared In</h4>
				<p><code class="declared-in-ref">RKManagedObjectStore.h</code></p>
			</div>
			
			
		</div>
	</div>
</div><div class="section-method">
	<a name="//api/name/initWithPersistentStoreCoordinator:" title="initWithPersistentStoreCoordinator:"></a>
	<h3 class="method-title"><code><a href="#//api/name/initWithPersistentStoreCoordinator:">&ndash;&nbsp;initWithPersistentStoreCoordinator:</a></code>
</h3>

	<div class="method-info">
		<div class="pointy-thing"></div>

		<div class="method-info-container">
			
			
			<div class="method-subsection brief-description">
				<p>Initializes the receiver with an existing persistent store coordinator.</p>
			</div>
			
		    

			<div class="method-subsection method-declaration"><code>- (instancetype)initWithPersistentStoreCoordinator:(NSPersistentStoreCoordinator *)<em>persistentStoreCoordinator</em></code></div>

		    
			
			<div class="method-subsection arguments-section parameters">
				<h4 class="method-subtitle parameter-title">Parameters</h4>
				<table class="argument-def parameter-def">
				
					<tr>
						<th scope="row" class="argument-name"><code>persistentStoreCoordinator</code></th>
						<td><p>The persistent store coordinator with which to initialize the receiver.</p></td>
					</tr>
				
				</table>
			</div>
			

			
			<div class="method-subsection return">
				<h4 class="method-subtitle parameter-title">Return Value</h4>
				<p>The receiver, initialized with the managed object model of the given persistent store coordinator and the persistent store coordinator.</p>
			</div>
			

			

			
			<div class="method-subsection discussion-section">
				<h4 class="method-subtitle">Discussion</h4>
				<p>The managed object model from the persistent store coordinator will be used to initialize the receiver and the given persistent store coordinator will be configured as the persistent store coordinator for the managed object store.</p>

<p>This initialization method provides for easy integration with an existing Core Data stack.</p>
			</div>
			

			

			

			
			<div class="method-subsection declared-in-section">
				<h4 class="method-subtitle">Declared In</h4>
				<p><code class="declared-in-ref">RKManagedObjectStore.h</code></p>
			</div>
			
			
		</div>
	</div>
</div><div class="section-method">
	<a name="//api/name/init" title="init"></a>
	<h3 class="method-title"><code><a href="#//api/name/init">&ndash;&nbsp;init</a></code>
</h3>

	<div class="method-info">
		<div class="pointy-thing"></div>

		<div class="method-info-container">
			
			
			<div class="method-subsection brief-description">
				<p>Initializes the receiver with a managed object model obtained by merging the models from all of the application&rsquo;s non-framework bundles.</p>
			</div>
			
		    

			<div class="method-subsection method-declaration"><code>- (instancetype)init</code></div>

		    
			

			

			

			
			<div class="method-subsection discussion-section">
				<h4 class="method-subtitle">Discussion</h4>
				<div class="warning"><p><strong>Warning:</strong> Obtaining a managed object model by merging all bundles may result in an application error if versioned object models are in use.</p></div>
			</div>
			

			

			

			
			<div class="method-subsection declared-in-section">
				<h4 class="method-subtitle">Declared In</h4>
				<p><code class="declared-in-ref">RKManagedObjectStore.h</code></p>
			</div>
			
			
		</div>
	</div>
</div>
						</div>
						

						<a title="Configuring Persistent Stores" name="task_Configuring Persistent Stores"></a>
						<h2 class="task-title">Configuring Persistent Stores</h2>

						<div class="task-list">
							<div class="section-method">
	<a name="//api/name/createPersistentStoreCoordinator" title="createPersistentStoreCoordinator"></a>
	<h3 class="method-title"><code><a href="#//api/name/createPersistentStoreCoordinator">&ndash;&nbsp;createPersistentStoreCoordinator</a></code>
</h3>

	<div class="method-info">
		<div class="pointy-thing"></div>

		<div class="method-info-container">
			
			
			<div class="method-subsection brief-description">
				<p>Creates a persistent store coordinator with the receiver&rsquo;s managed object model. After invocation, the <a href="#//api/name/persistentStoreCoordinator">persistentStoreCoordinator</a> property will no longer be nil.</p>
			</div>
			
		    

			<div class="method-subsection method-declaration"><code>- (void)createPersistentStoreCoordinator</code></div>

		    
			

			

			

			
			<div class="method-subsection discussion-section">
				<h4 class="method-subtitle">Discussion</h4>
				<div class="warning"><p><strong>Warning:</strong> Creating the persistent store coordinator will render the managed object model immutable. Attempts to use functionality that requires a mutable managed object model after the persistent store coordinator has been created will raise an application error.</p></div>
			</div>
			

			

			

			
			<div class="method-subsection declared-in-section">
				<h4 class="method-subtitle">Declared In</h4>
				<p><code class="declared-in-ref">RKManagedObjectStore.h</code></p>
			</div>
			
			
		</div>
	</div>
</div><div class="section-method">
	<a name="//api/name/addInMemoryPersistentStore:" title="addInMemoryPersistentStore:"></a>
	<h3 class="method-title"><code><a href="#//api/name/addInMemoryPersistentStore:">&ndash;&nbsp;addInMemoryPersistentStore:</a></code>
</h3>

	<div class="method-info">
		<div class="pointy-thing"></div>

		<div class="method-info-container">
			
			
			<div class="method-subsection brief-description">
				<p>Adds a new in memory persistent store to the persistent store coordinator of the receiver.</p>
			</div>
			
		    

			<div class="method-subsection method-declaration"><code>- (NSPersistentStore *)addInMemoryPersistentStore:(NSError **)<em>error</em></code></div>

		    
			
			<div class="method-subsection arguments-section parameters">
				<h4 class="method-subtitle parameter-title">Parameters</h4>
				<table class="argument-def parameter-def">
				
					<tr>
						<th scope="row" class="argument-name"><code>error</code></th>
						<td><p>On input, a pointer to an error object. If an error occurs, this pointer is set to an actual error object containing the error information. You may specify nil for this parameter if you do not want the error information.</p></td>
					</tr>
				
				</table>
			</div>
			

			
			<div class="method-subsection return">
				<h4 class="method-subtitle parameter-title">Return Value</h4>
				<p>The new persistent store, or nil in the event of an error.</p>
			</div>
			

			

			
			<div class="method-subsection discussion-section">
				<h4 class="method-subtitle">Discussion</h4>
				<p>This method will invoke createPersistentStore if a persistent store coordinator has not yet been created.</p>
			</div>
			

			

			

			
			<div class="method-subsection declared-in-section">
				<h4 class="method-subtitle">Declared In</h4>
				<p><code class="declared-in-ref">RKManagedObjectStore.h</code></p>
			</div>
			
			
		</div>
	</div>
</div><div class="section-method">
	<a name="//api/name/addSQLitePersistentStoreAtPath:fromSeedDatabaseAtPath:withConfiguration:options:error:" title="addSQLitePersistentStoreAtPath:fromSeedDatabaseAtPath:withConfiguration:options:error:"></a>
	<h3 class="method-title"><code><a href="#//api/name/addSQLitePersistentStoreAtPath:fromSeedDatabaseAtPath:withConfiguration:options:error:">&ndash;&nbsp;addSQLitePersistentStoreAtPath:fromSeedDatabaseAtPath:withConfiguration:options:error:</a></code>
</h3>

	<div class="method-info">
		<div class="pointy-thing"></div>

		<div class="method-info-container">
			
			
			<div class="method-subsection brief-description">
				<p>Adds a new SQLite persistent store, optionally initialized with a seed database, to the persistent store coordinator of the receiver.</p>
			</div>
			
		    

			<div class="method-subsection method-declaration"><code>- (NSPersistentStore *)addSQLitePersistentStoreAtPath:(NSString *)<em>storePath</em> fromSeedDatabaseAtPath:(NSString *)<em>seedPath</em> withConfiguration:(NSString *)<em>nilOrConfigurationName</em> options:(NSDictionary *)<em>nilOrOptions</em> error:(NSError **)<em>error</em></code></div>

		    
			
			<div class="method-subsection arguments-section parameters">
				<h4 class="method-subtitle parameter-title">Parameters</h4>
				<table class="argument-def parameter-def">
				
					<tr>
						<th scope="row" class="argument-name"><code>storePath</code></th>
						<td><p>The path at which to save the persistent store on disk.</p></td>
					</tr>
				
					<tr>
						<th scope="row" class="argument-name"><code>seedPath</code></th>
						<td><p>An optional path to a seed database to copy to the given storePath in the event that a store does not yet exist.</p></td>
					</tr>
				
					<tr>
						<th scope="row" class="argument-name"><code>nilOrConfigurationName</code></th>
						<td><p>An optional name of a Core Data configuration in the managed object model.</p></td>
					</tr>
				
					<tr>
						<th scope="row" class="argument-name"><code>nilOrOptions</code></th>
						<td><p>An optional dictionary of options with which to configure the persistent store. If <code>nil</code>, a dictionary of options enabling <code>NSMigratePersistentStoresAutomaticallyOption</code> and <code>NSInferMappingModelAutomaticallyOption</code> will be used.</p></td>
					</tr>
				
					<tr>
						<th scope="row" class="argument-name"><code>error</code></th>
						<td><p>On input, a pointer to an error object. If an error occurs, this pointer is set to an actual error object containing the error information. You may specify nil for this parameter if you do not want the error information.</p></td>
					</tr>
				
				</table>
			</div>
			

			

			

			
			<div class="method-subsection discussion-section">
				<h4 class="method-subtitle">Discussion</h4>
				<div class="bug"><p><strong>Bug:</strong> Note that when built for iOS, this method will set a resource value on the SQLite file backing the persistent store for the <code>NSURLIsExcludedFromBackupKey</code> key set to <code>YES</code> to exclude the SQLite file from being backed up by iCloud to conform with the <a href="https://developer.apple.com/icloud/documentation/data-storage/">&ldquo;iOS Data Storage Guidelines&rdquo;</a></p></div><div class="warning"><p><strong>Warning:</strong> If the seed database at the given path was created with an incompatible managed object model an application error may be raised.</p></div>
			</div>
			

			

			

			
			<div class="method-subsection declared-in-section">
				<h4 class="method-subtitle">Declared In</h4>
				<p><code class="declared-in-ref">RKManagedObjectStore.h</code></p>
			</div>
			
			
		</div>
	</div>
</div><div class="section-method">
	<a name="//api/name/resetPersistentStores:" title="resetPersistentStores:"></a>
	<h3 class="method-title"><code><a href="#//api/name/resetPersistentStores:">&ndash;&nbsp;resetPersistentStores:</a></code>
</h3>

	<div class="method-info">
		<div class="pointy-thing"></div>

		<div class="method-info-container">
			
			
			<div class="method-subsection brief-description">
				<p>Resets the persistent stores in the receiver&rsquo;s persistent store coordinator and recreates them. If a store being reset is backed by a file on disk (such as a SQLite file), the file will be removed prior to recreating the store. If the store was originally created using a seed database, the seed will be recopied to reset the store to its seeded state. If the managed object model uses External Storage for any of its entities, then the external storage directory will be recursively deleted when the store is reset.</p>
			</div>
			
		    

			<div class="method-subsection method-declaration"><code>- (BOOL)resetPersistentStores:(NSError **)<em>error</em></code></div>

		    
			
			<div class="method-subsection arguments-section parameters">
				<h4 class="method-subtitle parameter-title">Parameters</h4>
				<table class="argument-def parameter-def">
				
					<tr>
						<th scope="row" class="argument-name"><code>error</code></th>
						<td><p>On input, a pointer to an error object. If an error occurs, this pointer is set to an actual error object containing the error information. You may specify nil for this parameter if you do not want the error information.</p></td>
					</tr>
				
				</table>
			</div>
			

			
			<div class="method-subsection return">
				<h4 class="method-subtitle parameter-title">Return Value</h4>
				<p>A Boolean value indicating if the reset was successful.</p>
			</div>
			

			

			
			<div class="method-subsection discussion-section">
				<h4 class="method-subtitle">Discussion</h4>
				<div class="bug"><p><strong>Bug:</strong> This method will implictly result in the managed object contexts associated with the receiver to be discarded and recreated. Any managed objects or additional child contexts associated with the store will need to be discarded or else exceptions may be raised (i.e. <code>NSObjectInaccessibleException</code>).</p>

<p>Also note that care must be taken to cancel/suspend all mapping operations, reset all managed object contexts, and disconnect all <code>NSFetchedResultController</code> objects that are associated with managed object contexts using the persistent stores of the receiver before attempting a reset. Failure to completely disconnect usage before calling this method is likely to result in a deadlock.</p>

<p>As an alternative to resetting the persistent store, you may wish to consider simply deleting all managed objects out of the managed object context. If your data set is not very large, this can be a performant operation and is significantly easier to implement correctly. An example implementation for truncating all managed objects from the store is provided below:</p>

<pre><code>NSBlockOperation *operation = [NSBlockOperation blockOperationWithBlock:^{
    NSManagedObjectContext *managedObjectContext = [RKManagedObjectStore defaultStore].persistentStoreManagedObjectContext;
    [managedObjectContext performBlockAndWait:^{
        NSError *error = nil;
        for (NSEntityDescription *entity in [RKManagedObjectStore defaultStore].managedObjectModel) {
            NSFetchRequest *fetchRequest = [NSFetchRequest new];
            [fetchRequest setEntity:entity];
            [fetchRequest setIncludesSubentities:NO];
            NSArray *objects = [managedObjectContext executeFetchRequest:fetchRequest error:&amp;error];
            if (! objects) RKLogWarning(@"Failed execution of fetch request %@: %@", fetchRequest, error);
            for (NSManagedObject *managedObject in objects) {
                [managedObjectContext deleteObject:managedObject];
            }
        }

        BOOL success = [managedObjectContext save:&amp;error];
        if (!success) RKLogWarning(@"Failed saving managed object context: %@", error);
        }];
}];
[operation setCompletionBlock:^{
    // Do stuff once the truncation is complete
}];
[operation start];
</code></pre></div>
			</div>
			

			

			

			
			<div class="method-subsection declared-in-section">
				<h4 class="method-subtitle">Declared In</h4>
				<p><code class="declared-in-ref">RKManagedObjectStore.h</code></p>
			</div>
			
			
		</div>
	</div>
</div>
						</div>
						

						<a title="Retrieving Details about the Store" name="task_Retrieving Details about the Store"></a>
						<h2 class="task-title">Retrieving Details about the Store</h2>

						<div class="task-list">
							<div class="section-method">
	<a name="//api/name/managedObjectModel" title="managedObjectModel"></a>
	<h3 class="method-title"><code><a href="#//api/name/managedObjectModel">&nbsp;&nbsp;managedObjectModel</a></code>
</h3>

	<div class="method-info">
		<div class="pointy-thing"></div>

		<div class="method-info-container">
			
			
			<div class="method-subsection brief-description">
				<p>Returns the managed object model of the receiver.</p>
			</div>
			
		    

			<div class="method-subsection method-declaration"><code>@property (nonatomic, strong, readonly) NSManagedObjectModel *managedObjectModel</code></div>

		    
			

			
			<div class="method-subsection return">
				<h4 class="method-subtitle parameter-title">Return Value</h4>
				<p>The managed object model of the receiver.</p>
			</div>
			

			

			

			

			

			
			<div class="method-subsection declared-in-section">
				<h4 class="method-subtitle">Declared In</h4>
				<p><code class="declared-in-ref">RKManagedObjectStore.h</code></p>
			</div>
			
			
		</div>
	</div>
</div><div class="section-method">
	<a name="//api/name/persistentStoreCoordinator" title="persistentStoreCoordinator"></a>
	<h3 class="method-title"><code><a href="#//api/name/persistentStoreCoordinator">&nbsp;&nbsp;persistentStoreCoordinator</a></code>
</h3>

	<div class="method-info">
		<div class="pointy-thing"></div>

		<div class="method-info-container">
			
			
			<div class="method-subsection brief-description">
				<p>Returns the persistent store coordinator of the receiver.</p>
			</div>
			
		    

			<div class="method-subsection method-declaration"><code>@property (nonatomic, strong, readonly) NSPersistentStoreCoordinator *persistentStoreCoordinator</code></div>

		    
			

			
			<div class="method-subsection return">
				<h4 class="method-subtitle parameter-title">Return Value</h4>
				<p>The persistent store coordinator of the receiver.</p>
			</div>
			

			

			

			

			

			
			<div class="method-subsection declared-in-section">
				<h4 class="method-subtitle">Declared In</h4>
				<p><code class="declared-in-ref">RKManagedObjectStore.h</code></p>
			</div>
			
			
		</div>
	</div>
</div><div class="section-method">
	<a name="//api/name/managedObjectCache" title="managedObjectCache"></a>
	<h3 class="method-title"><code><a href="#//api/name/managedObjectCache">&nbsp;&nbsp;managedObjectCache</a></code>
</h3>

	<div class="method-info">
		<div class="pointy-thing"></div>

		<div class="method-info-container">
			
			
			<div class="method-subsection brief-description">
				<p>The managed object cache associated with the receiver.</p>
			</div>
			
		    

			<div class="method-subsection method-declaration"><code>@property (nonatomic, strong) id&lt;RKManagedObjectCaching&gt; managedObjectCache</code></div>

		    
			

			

			

			
			<div class="method-subsection discussion-section">
				<h4 class="method-subtitle">Discussion</h4>
				<p>The managed object cache is used to accelerate intensive Core Data operations by caching managed objects by one or more attributes.</p>

<p><strong>Default</strong>: An instance of <a href="../Classes/RKFetchRequestManagedObjectCache.html"><code>RKFetchRequestManagedObjectCache</code></a>.</p><div class="warning"><p><strong>Warning:</strong> A nil managed object cache will result in a store that is unable to uniquely identify existing objects by identification attributes and may result in the creation of duplicate objects within the store.</p></div>
			</div>
			

			

			

			
			<div class="method-subsection declared-in-section">
				<h4 class="method-subtitle">Declared In</h4>
				<p><code class="declared-in-ref">RKManagedObjectStore.h</code></p>
			</div>
			
			
		</div>
	</div>
</div>
						</div>
						

						<a title="Working with Managed Object Contexts" name="task_Working with Managed Object Contexts"></a>
						<h2 class="task-title">Working with Managed Object Contexts</h2>

						<div class="task-list">
							<div class="section-method">
	<a name="//api/name/createManagedObjectContexts" title="createManagedObjectContexts"></a>
	<h3 class="method-title"><code><a href="#//api/name/createManagedObjectContexts">&ndash;&nbsp;createManagedObjectContexts</a></code>
</h3>

	<div class="method-info">
		<div class="pointy-thing"></div>

		<div class="method-info-container">
			
			
			<div class="method-subsection brief-description">
				<p>Creates the persistent store and main queue managed object contexts for the receiver.</p>
			</div>
			
		    

			<div class="method-subsection method-declaration"><code>- (void)createManagedObjectContexts</code></div>

		    
			

			

			

			

			

			

			
			<div class="method-subsection declared-in-section">
				<h4 class="method-subtitle">Declared In</h4>
				<p><code class="declared-in-ref">RKManagedObjectStore.h</code></p>
			</div>
			
			
		</div>
	</div>
</div><div class="section-method">
	<a name="//api/name/persistentStoreManagedObjectContext" title="persistentStoreManagedObjectContext"></a>
	<h3 class="method-title"><code><a href="#//api/name/persistentStoreManagedObjectContext">&nbsp;&nbsp;persistentStoreManagedObjectContext</a></code>
</h3>

	<div class="method-info">
		<div class="pointy-thing"></div>

		<div class="method-info-container">
			
			
			<div class="method-subsection brief-description">
				<p>Returns the managed object context of the receiver that is associated with the persistent store coordinator and is responsible for managing persistence.</p>
			</div>
			
		    

			<div class="method-subsection method-declaration"><code>@property (nonatomic, strong, readonly) NSManagedObjectContext *persistentStoreManagedObjectContext</code></div>

		    
			

			

			

			
			<div class="method-subsection discussion-section">
				<h4 class="method-subtitle">Discussion</h4>
				<p>The persistent store context is created with the <code>NSPrivateQueueConcurrencyType</code> and as such must be interacted with using <code>[NSManagedObjectContext performBlock:]</code> or <code>[NSManagedObjectContext performBlockAndWait:]</code>. This context typically serves as the parent context for scratch contexts or main queue contexts for interacting with the user interface. Created by the invocation of <a href="#//api/name/createManagedObjectContexts"><code>createManagedObjectContexts</code></a>.</p>
			</div>
			

			

			

			
			<div class="method-subsection declared-in-section">
				<h4 class="method-subtitle">Declared In</h4>
				<p><code class="declared-in-ref">RKManagedObjectStore.h</code></p>
			</div>
			
			
		</div>
	</div>
</div><div class="section-method">
	<a name="//api/name/mainQueueManagedObjectContext" title="mainQueueManagedObjectContext"></a>
	<h3 class="method-title"><code><a href="#//api/name/mainQueueManagedObjectContext">&nbsp;&nbsp;mainQueueManagedObjectContext</a></code>
</h3>

	<div class="method-info">
		<div class="pointy-thing"></div>

		<div class="method-info-container">
			
			
			<div class="method-subsection brief-description">
				<p>The main queue managed object context of the receiver.</p>
			</div>
			
		    

			<div class="method-subsection method-declaration"><code>@property (nonatomic, strong, readonly) NSManagedObjectContext *mainQueueManagedObjectContext</code></div>

		    
			

			

			

			
			<div class="method-subsection discussion-section">
				<h4 class="method-subtitle">Discussion</h4>
				<p>The main queue context is available for usage on the main queue to drive user interface needs. The context is created with the NSMainQueueConcurrencyType and as such may be messaged directly from the main thread. The context is a child context of the <a href="#//api/name/persistentStoreManagedObjectContext">persistentStoreManagedObjectContext</a> and can persist changes up to the parent via a save.</p>
			</div>
			

			

			

			
			<div class="method-subsection declared-in-section">
				<h4 class="method-subtitle">Declared In</h4>
				<p><code class="declared-in-ref">RKManagedObjectStore.h</code></p>
			</div>
			
			
		</div>
	</div>
</div><div class="section-method">
	<a name="//api/name/newChildManagedObjectContextWithConcurrencyType:tracksChanges:" title="newChildManagedObjectContextWithConcurrencyType:tracksChanges:"></a>
	<h3 class="method-title"><code><a href="#//api/name/newChildManagedObjectContextWithConcurrencyType:tracksChanges:">&ndash;&nbsp;newChildManagedObjectContextWithConcurrencyType:tracksChanges:</a></code>
</h3>

	<div class="method-info">
		<div class="pointy-thing"></div>

		<div class="method-info-container">
			
			
			<div class="method-subsection brief-description">
				<p>Creates a new child managed object context of the persistent store managed object context with a given concurrency type, optionally tracking changes saved to the parent context and merging them on save.</p>
			</div>
			
		    

			<div class="method-subsection method-declaration"><code>- (NSManagedObjectContext *)newChildManagedObjectContextWithConcurrencyType:(NSManagedObjectContextConcurrencyType)<em>concurrencyType</em> tracksChanges:(BOOL)<em>tracksChanges</em></code></div>

		    
			
			<div class="method-subsection arguments-section parameters">
				<h4 class="method-subtitle parameter-title">Parameters</h4>
				<table class="argument-def parameter-def">
				
					<tr>
						<th scope="row" class="argument-name"><code>concurrencyType</code></th>
						<td><p>The desired concurrency type for the new context.</p></td>
					</tr>
				
					<tr>
						<th scope="row" class="argument-name"><code>tracksChanges</code></th>
						<td><p>When <code>YES</code>, the new context will observe the <a href="#//api/name/persistentStoreManagedObjectContext"><code>persistentStoreManagedObjectContext</code></a> for save events and merge in any changes via <code>[NSManagedObjectContext mergeChangesFromContextDidSaveNotification:]</code>.</p></td>
					</tr>
				
				</table>
			</div>
			

			
			<div class="method-subsection return">
				<h4 class="method-subtitle parameter-title">Return Value</h4>
				<p>A newly created managed object context with the given concurrency type whose parent is the <a href="#//api/name/persistentStoreManagedObjectContext"><code>persistentStoreManagedObjectContext</code></a>.</p>
			</div>
			

			

			

			

			

			
			<div class="method-subsection declared-in-section">
				<h4 class="method-subtitle">Declared In</h4>
				<p><code class="declared-in-ref">RKManagedObjectStore.h</code></p>
			</div>
			
			
		</div>
	</div>
</div>
						</div>
						

						<a title="Performing Migrations" name="task_Performing Migrations"></a>
						<h2 class="task-title">Performing Migrations</h2>

						<div class="task-list">
							<div class="section-method">
	<a name="//api/name/migratePersistentStoreOfType:atURL:toModelAtURL:error:configuringModelsWithBlock:" title="migratePersistentStoreOfType:atURL:toModelAtURL:error:configuringModelsWithBlock:"></a>
	<h3 class="method-title"><code><a href="#//api/name/migratePersistentStoreOfType:atURL:toModelAtURL:error:configuringModelsWithBlock:">+&nbsp;migratePersistentStoreOfType:atURL:toModelAtURL:error:configuringModelsWithBlock:</a></code>
</h3>

	<div class="method-info">
		<div class="pointy-thing"></div>

		<div class="method-info-container">
			
			
			<div class="method-subsection brief-description">
				<p>Performs a migration on a persistent store at a given URL to the model at the specified URL.</p>
			</div>
			
		    

			<div class="method-subsection method-declaration"><code>+ (BOOL)migratePersistentStoreOfType:(NSString *)<em>storeType</em> atURL:(NSURL *)<em>storeURL</em> toModelAtURL:(NSURL *)<em>destinationModelURL</em> error:(NSError **)<em>error</em> configuringModelsWithBlock:(void ( ^ ) ( NSManagedObjectModel *model , NSURL *sourceURL ))<em>block</em></code></div>

		    
			
			<div class="method-subsection arguments-section parameters">
				<h4 class="method-subtitle parameter-title">Parameters</h4>
				<table class="argument-def parameter-def">
				
					<tr>
						<th scope="row" class="argument-name"><code>storeType</code></th>
						<td><p>The type of store that given URL. May be <code>nil</code>.</p></td>
					</tr>
				
					<tr>
						<th scope="row" class="argument-name"><code>storeURL</code></th>
						<td><p>A URL to the store that is to be migrated.</p></td>
					</tr>
				
					<tr>
						<th scope="row" class="argument-name"><code>destinationModelURL</code></th>
						<td><p>A URL to the managed object model that the persistent store is to be updated to. This URL may target a specific model version with a .momd package or point to the .momd package itself, in which case the migration is performed to the current version of the model as configured on the .xcdatamodeld file used to the build the .momd package.</p></td>
					</tr>
				
					<tr>
						<th scope="row" class="argument-name"><code>error</code></th>
						<td><p>A pointer to an error object that is set in the event that the migration is unsuccessful.</p></td>
					</tr>
				
					<tr>
						<th scope="row" class="argument-name"><code>block</code></th>
						<td><p>A block object used to configure</p></td>
					</tr>
				
				</table>
			</div>
			

			

			

			
			<div class="method-subsection discussion-section">
				<h4 class="method-subtitle">Discussion</h4>
				<p>This method provides support for migrating persistent stores in which the source and destination models have been mutated after being loaded from the model archive on disk, such as when the RestKit managed object searching support is used. In a situation where the persistent store has been created with a dynamically modified managed object model. Core Data is unable to infer the mapping model because the metadata of the persistent store does not agree with that of the managed object model due to the dynamic modifications. In order to perform a migration, one must load the appropriate source model, apply the dynamic changes appropriate for that model, then infer a mapping model from the modified model. This method assists in this process by accepting a source store and a destination model as arguments and searching through all models in the .momd package and yielding each model to the given configuration block for processing. After the block is invoked, the metadata of the store is checked for compatibility with the modified managed object model to identify the source store. Once the source store is found, a mapping model is inferred and the migration proceeds. The migration is done against a copy of the given persistent store and if successful, the migrated store is moved to replace the original store.</p>

<p>To understand how this is used, consider the following example: Given a managed object model containing two entities &lsquo;Article&rsquo; and &lsquo;Tag&rsquo;, the user wishes to configure managed object search indexing on the models and wishes to be able to migrate existing persistent stores across versions. The migration configuration would look something like this:</p>

<pre><code> NSURL *storeURL = [RKApplicationDataDirectory() stringByAppendingPathComponent:@"MyStore.sqlite"];
 NSURL *modelURL = [[RKTestFixture fixtureBundle] URLForResource:@"VersionedModel" withExtension:@"momd"];
 BOOL success = [RKManagedObjectStore migratePersistentStoreOfType:NSSQLiteStoreType atURL:storeURL toModelAtURL:modelURL error:&amp;error configuringModelsWithBlock:^(NSManagedObjectModel *model, NSURL *sourceURL) {
    // Examine each model and configure search indexing appropriately based on the versionIdentifiers configured in the model
    if ([[model versionIdentifiers] isEqualToSet:[NSSet setWithObject:@"1.0"]]) {
        NSEntityDescription *articleEntity = [[model entitiesByName] objectForKey:@"Article"];
        NSEntityDescription *tagEntity = [[model entitiesByName] objectForKey:@"Tag"];
        [RKSearchIndexer addSearchIndexingToEntity:articleEntity onAttributes:@[ @"title" ]];
        [RKSearchIndexer addSearchIndexingToEntity:tagEntity onAttributes:@[ @"name" ]];
    } else if ([[model versionIdentifiers] isEqualToSet:[NSSet setWithObject:@"2.0"]]) {
        NSEntityDescription *articleEntity = [[model entitiesByName] objectForKey:@"Article"];
        NSEntityDescription *tagEntity = [[model entitiesByName] objectForKey:@"Tag"];
        [RKSearchIndexer addSearchIndexingToEntity:articleEntity onAttributes:@[ @"title", @"body" ]];
        [RKSearchIndexer addSearchIndexingToEntity:tagEntity onAttributes:@[ @"name" ]];
    } else if ([[model versionIdentifiers] containsObject:@"3.0"] || [[model versionIdentifiers] containsObject:@"4.0"]) {
        // We index the same attributes on v3 and v4
        NSEntityDescription *articleEntity = [[model entitiesByName] objectForKey:@"Article"];
        NSEntityDescription *tagEntity = [[model entitiesByName] objectForKey:@"Tag"];
        [RKSearchIndexer addSearchIndexingToEntity:articleEntity onAttributes:@[ @"title", @"body", @"authorName" ]];
        [RKSearchIndexer addSearchIndexingToEntity:tagEntity onAttributes:@[ @"name" ]];
    }
 }];
</code></pre><div class="warning"><p><strong>Warning:</strong> This method is only usable with a versioned Managed Object Model stored as a .momd package containing .mom managed object model archives.</p></div>
			</div>
			

			

			

			
			<div class="method-subsection declared-in-section">
				<h4 class="method-subtitle">Declared In</h4>
				<p><code class="declared-in-ref">RKManagedObjectStore.h</code></p>
			</div>
			
			
		</div>
	</div>
</div>
						</div>
						

						
						<h2 class="task-title">Other Methods</h2>

						<div class="task-list">
							<div class="section-method">
	<a name="//api/name/copySeedDatabaseIfNecessaryFromPath:toPath:error:" title="copySeedDatabaseIfNecessaryFromPath:toPath:error:"></a>
	<h3 class="method-title"><code><a href="#//api/name/copySeedDatabaseIfNecessaryFromPath:toPath:error:">&ndash;&nbsp;copySeedDatabaseIfNecessaryFromPath:toPath:error:</a></code>
</h3>

	<div class="method-info">
		<div class="pointy-thing"></div>

		<div class="method-info-container">
			
			
			<div class="method-subsection brief-description">
				<pre><code> There seems to be trouble with combining configurations and migration. So do this in two steps: first, attach the store with NO configuration, but WITH migration options; then remove it and reattach WITH configuration, but NOT migration options.

 http://blog.atwam.com/blog/2012/05/11/multiple-persistent-stores-and-seed-data-with-core-data/
 http://stackoverflow.com/questions/1774359/core-data-migration-error-message-model-does-not-contain-configuration-xyz
</code></pre>
			</div>
			
		    

			<div class="method-subsection method-declaration"><code>- (BOOL)copySeedDatabaseIfNecessaryFromPath:(NSString *)<em>seedPath</em> toPath:(NSString *)<em>storePath</em> error:(NSError **)<em>error</em></code></div>

		    
			

			

			

			

			

			

			
			<div class="method-subsection declared-in-section">
				<h4 class="method-subtitle">Declared In</h4>
				<p><code class="declared-in-ref">RKManagedObjectStore.m</code></p>
			</div>
			
			
		</div>
	</div>
</div>
						</div>
						
					</div>
					
					

                    
                    
          
				</main>

				<footer>
					<div class="footer-copyright">
						
						<p class="copyright">Copyright &copy; 2015 TIBCO Jaspersoft. All rights reserved. Updated: 2015-09-21</p>
						
						
						<p class="generator">Generated by <a href="http://appledoc.gentlebytes.com">appledoc 2.2.1 (build 1334)</a>.</p>
						
					</div>
				</footer>
			</div>
		</div>
	</article>

	<script src="../js/script.js"></script>
</body>
</html>